<script>

    function crearTarjetas() {
        limpiar();

        google.script.run
            .withSuccessHandler(crearTarjetasCorrectamente)
            .withFailureHandler(crearTarjetasError)
            .obtenerDatos();
    }

    function crearTarjetasError() {
        //Mostrar notificaciÃ³n de error
        crearNotificacionError('No se han podido crear las tarjetas', 'ERROR');

        //Eliminamos loader
        eliminarLoader();
    }

    function crearTarjetasCorrectamente(datos) {
        //Extraer los contactos
        let contactos = extraerContactos(datos);

        let tarjetas = document.createElement('div');
        tarjetas.id = "tarjetasContacto";
        tarjetas.classList.add("d-flex", "justify-content-center", "flex-wrap");

        //Por cada contacto crear una tarjeta
        contactos.forEach(contacto => tarjetas.appendChild(crearContactoPlantilla(contacto)));

        //Agregar tarjetas
        document.getElementById('divContactos').appendChild(tarjetas);

        //Eliminamos loader
        eliminarLoader();
    }

</script>